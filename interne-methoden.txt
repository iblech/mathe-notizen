=== Ein paar Eigenschaften

* Eig. koh. Moduln kann man super intern zeigen!
  vgl. http://amathew.files.wordpress.com/2010/07/031.pdf

* X reduziertes Schema <==>
    Sh(X) |== für alle s : O_X. [s nicht invertierbar ==> s = 0].

* X beliebiges Schema. Dann erfüllt O_X in Sh(X) folgende Eigenschaft:
    für alle s : O_X. [s nicht invertierbar ==> s nilpotent].

* Topologischer Raum X zusammenhängend <==>
    Die interne Sprache von Sh(X) erfüllt folgende Eigenschaft:
    Seien phi, psi zwei disjunkte Aussagen (d.h. phi und psi ==> _|_).
    Dann folgt aus Sh(X) |== (phi oder psi), dass Sh(X) |== phi oder
    dass Sh(X) |== psi.

* Sei X topologischer Raum und phi eine Aussage der internen Sprache von Sh(X).
  Dann gilt: [[phi]] ist genau dann eine dichte Teilmenge von X, wenn
      Sh(X) |== nicht nicht phi.

* Sei X topologischer Raum. Dann ist genau dann jede nichtleere offene
  Teilmenge von X dicht, wenn für jede Aussage phi gilt:
      nicht (Sh(X) |== nicht phi)   ==>   Sh(X) |== nicht nicht phi.

* X reduziertes Schema, F Modul von endlichem Typ.
  Dann gilt: Sh(X) |== F ist nicht nicht frei (von endlichem Rang),
  also ist F lokal frei auf einer dichten Teilmenge!


=== Unterschema

* Definiere für Punkte x0 \in X (X ein LRS) einen neuen Operator in der internen
  Sprache:

      U |== !x0  gdw.  x0 \not\in U.

  Diese Erweiterung erfüllt weiterhin das Lokalitätsaxiom. Sie ist auch einfach
  das Prädikat zum offenen Kern von (X \ {x0}).

* Für eine Funktion f \in O_X(X) gilt:

      f = 0 \in k(x0)  <==>  X |== (f inv. ==> !x0).

  "==>": Sei U \subseteq X. Sei f auf U invertierbar. Dann ist f auch in allen
  k(x), x \in U, invertierbar. Also x0 \not\in U.

  "<==": Auf D(f) ist f invertierbar. Also muss x0 \not\in D(f) sein. Also ist
  f in O_{X,x0} nicht invertierbar, liegt somit im maximalen Ideal und ist im
  Körper k(x0) Null.

* Daraus folgere ich: Das Ideal vorne in der kurzen exakten Sequenz zum
  Unterschema Spec k(x0) (falls x0 abgeschlossen),

      0 --> I --> O_X --> i_* O_k(x0) --> 0,

  kann in der internen Sprache durch

      { f : O_X | f invertierbar ==> !x0 }

  gegeben werden.

* Was passiert bei anderen Aussagen phi statt "!x0"? Ideale erhält man in jedem
  Fall.

* Kann man dadurch auch größere Unterschemata charakterisieren?

* Kann man die Ideale der obigen Form irgendwie charakterisieren?

* I ist eine Art maximales Ideal:

  * X |== 1 \in J ist gleichbedeutend mit X |== !x0.
    Das ist genau dann richtig, wenn X = {x0}.

  * X |== forall f,g : O. fg \in J ==> f \in J oder g \in J
    gilt, denn für f, g : O(U) mit fg = 0 in k(x0) folgt
    f = 0 oder g = 0 in k(x0). (Falls x0 \not\in U, ist "= 0" in k(x0) eine
    triviale wahre Aussage.)

  * U |== nicht (f \in J) bedeutet für f \in O(U),
    dass f auf einer dichten offenen Teilmenge von U invertierbar ist und
    dass alle nichtleeren offenen Teilmengen von U x0 enthalten.

  * Daher gilt X |== forall f : O. f \not\in J ==> J + (f) = (1).
    Denn sei f \in O(U) beliebig mit U |== nicht (f in J).
    Ohne Einschränkung sei U nicht leer.
    Dann ist f auf einer offenen dichten Teilmenge V von U invertierbar. Diese
    muss x0 enthalten. Überdecke U durch V und (U \ {x0}); hierbei geht die
    Abgeschlossenheit von x0 ein. Auf V gilt intern, dass (f) das Einsideal
    ist. Auf (U \ {x0}) gilt intern, dass J das Einsideal ist (da dort !x0
    gilt).


=== Internes Spektrum

* O_X in Sh(X), also dem kleinen Zariski-Topos, hat im Allgemeinen noch viele
  maximale Ideale: die Idealgarben zu abgeschlossenen Punkten.


=== Rationale Funktionen

* Intern kann man die Teilmenge

      S := { f : O_X | f regulär }

  definieren. Diese ist multiplikativ abgeschlossen. Da "f regulär" für festes
  f \in O_X(U) eine geometrische Implikation ist, gilt:

      S(U) = { f \in O_X(U) | f regulär in allen O_{X,x}, x \in U }.

  Dabei verwendet: [[ { x : F | phi(x) } ]](U) = { x \in F(U) | U |== phi(x) }.
  (Damit kann man die Behauptung zumindest explizit per Hand abkürzen. Ob die
  geometrische Form schon genügt, weiß ich gerade nicht.)

* Daher kann man intern S^(-1) O_X bilden.

* Die extern definierte Ringgarbe K rationaler Funktionen erfüllt dieselbe
  universelle Eigenschaft:

      Sei U \subseteq X. Sei F Ringgarbe auf U. Sei phi : O_X --> F
      Ringhomo, der aus interner Sicht reguläre Elemente auf invertierbare
      schickt; das ist extern äquivalent dazu, dass er auf allen offenen Teilmengen V
      die Elemente aus S(V) auf invertierbare Elemente schickt.

      Dann gibt es genau einen Morphismus K^pre|_U --> F, der das Dreieck
      O_U --> K^pre --> F zum Kommutieren bringt. Wegen der Lokalität der
      Vergarbung gibt es daher genau einen Morphismus K|_U = a(K^pre|_U), der
      das Dreieck K^pre|_U --> K|_U --> F zum Kommutieren bringt.
 
  Dabei verwendet: Stack-Semantik, um die universelle Eigenschaft richtig zu
  interpretieren; Lokalität der Vergarbung; Beschreibung von K aus
  http://therisingsea.org/notes/Section2.6-Divisors.pdf.
  Siehe auch http://therisingsea.org/notes/Section2.8-Differentials.pdf.

* Also kann ich K intern verstehen als S^(-1) O_X! :-)

* Außerdem ist UNSINN, dass der Halm K_x gleich dem totalen Quotientenring von
  O_{X,x} ist. Denn "S^(-1) O_X ist eine geometrische Konstruktion und ist
  daher mit Pullback verträglich". Genauer: S^(-1) O_X passt in die kurze
  Sequenz

      0 --> { (a/s; b/t) | ta = sb } --> (O_X x Reg(O_X))^2 --> S^(-1) O_X --> 0.

  Diese bleibt beim Nehmen des Halms exakt und geht in die erwarteten Terme
  über. URPDATE: Nicht ganz. Der Halm von Reg(O_X) an einer Stelle bettet zwar
  immer injektiv ein, kann aber echt kleiner sein als Reg(O_{X,x}). "Reg" ist
  nämlich auch keine geometrische Konstruktion.

  Kleiman schreibt, dass wenn X lokal noethersch oder wenn X reduziert ist und
  die Menge der irreduziblen Komponenten lokal endlich ist, es doch stimmt.


=== Cartier-Divisoren und Geradenbündel

* Ein rationaler Schnitt eines Geradenbündels L ist wohl dasselbe wie
  ein globaler Schnitt von L tensor_O K.

* So einem Schnitt kann man ein eindeutiges Element aus K_X/O_X^* zuordnen
  (f ~ g <==> f = u g für ein u aus O_X^*), und zwar wie folgt:

  Sei q aus L[S^(-1)] vorgegeben.
  Dann gibt es x, s mit q = x/s.
  Ferner gibt es phi : L --> O_X Iso.
  Setze f := phi(x) / s in K_X.
  Dann ist [f] die gesuchte Klasse.

  Man kann nachrechnen, dass diese Klasse nicht von den Wahlen (x, s, phi)
  abhängt. Daher definiert das wirklich ein globales Element von K_X^*/O_X^*.
  Formal zeigt man also:

      exists! a : K_X/O_X^*:
          exists f : K_X. exists x : L. exists s : S. exists phi : L --> O_X.
              a = [f] und q = x/s und f = phi(x)/s.

* Zu einem nichtverschwindenden Element D aus K_X^*/O_X^* kann ich ein
  Geradenbündel O_X(D) zuordnen:

  Schreibe D = [f]. Dann O_X(D) := 1/f * O_X \subseteq K_X.

  Wie oben ist das Unabhängigkeit von der Wahl von f. Mit "nicht verschwindend"
  muss gemeint sein, dass f in K_X invertierbar ist. Das ist genau dann der
  Fall, wenn der Zähler regulär ist.

* Sei dann s ein nichtverschwindender rationaler Schnitt eines Geradenbündels L.
  Dann kann man in der internen Sprache explizit einen Iso

      L --> O(div s)

  hinschreiben: Sei z aus L beliebig. Sei s = x/s. Sei phi : L --> O_X.
  Dann div(s) = [phi(x)/s]. Also O(div(s)) = s/phi(x) * O_X. Ordne daher z auf
  s/phi(x) * phi(z) ab.

* Dann kann man in der internen Sprache beweisen:
  Genau dann hat man einen globalen Iso O(D) --> O(D'),
  wenn man einen globalen Schnitt f von K_X^* mit D - D' = [f] hat.

  Explizit: Sei phi : O(D) --> O(D') ein Iso. Schreibe D = [g], D' = [g'].
  Dann gibt es ein p : O_X mit phi(1/g) = 1/g' * p.
  Setze dann f := phi(1/g) / (1/g) = g/g' * p : K_X.
  Dann kann man nachrechnen, dass f in K_X invertierbar ist (also p regulär in
  O_X ist), dass g/g' = u f für ein invertierbares u : O_X (also p invertierbar
  in O_X) und dass f unabhängig von der Wahl von g ist.

  Umgekehrt: Sei f ein globaler Schnitt von K_X^* mit D - D' = [f].
  Schreibe D = [g] und D' = [g']. Dann g/g' = u f für ein invertierbares u : O_X.
  Dann ist O(D) --> O(D'), h |--> h * f ein Iso. Die Wohldefiniertheit kann man
  natürlich intern zeigen: Ein h = p/g wird auf pf/g = u^(-1) p/g' abgebildet.

* Ebenso einfach: Jeder O_X-Untermodul F von K_X, der lokal vom Rang 1 ist, ist
  von der Form O(D) für einen Cartier-Divisor D.

  Intern habe einen Iso phi : F --> O_X.
  Es ist phi^(-1)(1) \in F \subseteq K_X.
  Kann also D := [ 1 / phi^(-1)(1) ] definieren.

  Dann kann man zeigen: D ist wohldefiniert (d.h. phi^(-1)(1) ist tatsächlich
  in K_X invertierbar) und unabhängig von der Wahl von phi.
  Nutze für letzteres die Identität psi(phi^(-1)(h)) = h * psi(phi^(-1)(1)),
  wobei der zweite Faktor ein invertierbares Element aus O_X ist.


=== Induktionsbeweise für Vektorbündel

Beweise Lemma 3 von
http://mathriding.wordpress.com/2012/12/06/vector-bundles-locally-free-sheaves-and-divisors-on-a-curve/:

Sei E ein Vektorbündel vom Rang r. Dann gibt es eine kurze exakte Sequenz

    0 --> L --> E --> E' --> 0,

wobei L ein Geradenbündel und E' ein Vektorbündel vom Rang r-1 ist.


=== Nächste Schritte

* "Lemma 3" oben beweisen

* Manche Aussagen phi erfüllen folgende Regel:
  x |== phi  <==>  U |== phi für eine Umgebung U von x
  Kann man allgemein sagen, welche das sind?

* Welches Transferprinzip gilt zwischen Aussagen für
  A-Moduln M und A~-Moduln M~ auf Spec A?

* Gibt es einen Operator B (eine Lawvere-Tierney-Topologie?)
  derart, dass B phi genau dann gilt, wenn phi auf einer offenen dichten
  Teilmenge gilt? Beweise damit, dass Moduln v.e.T. auf integren Schemata auf
  einer dichten Teilmenge lokal frei sind!

* Wie Marcs topos-theoretische Sicht auf Arbeit mit generischen Situationen
  formalisieren?

* Hatte interne Garben bzg. Lawvere-Tierney-Topologien mal verstanden.
  Wieder verstehen und aufschreiben!

* Ist eine Garbe genau dann lokal konstant, wenn sie aus interner Sicht diskret
  ist? Vermutlich nicht! Gegenbeispiel? Wie kann man denn konstante oder lokal
  konstante Garben intern erkennen? Vielleicht irgendwie, dass sie unter jedem
  phi gleich aussehen?

* Was hat Marc zu internen Dedekindringen gesagt?
  Sei X = Spec(Zahlkörper). Dann Sh(X) |= "O_X ist ein Hauptidealbereich". ?

* Schema X genau dann lokal von endlicher Präsentation,
  wenn Hom(__, X) (bestimmte) Limiten bewahrt!
  Siehe: http://stacks.math.columbia.edu/download/limits.pdf

* Erhalte ich X_red, indem ich O_X/sqrt(0) intern betrachte?

* Richmans "enabling conditions" topostheoretisch verstehen!

* Klassifikation der Vektorbündel auf P^1 und A^1 intern möglich?
  (Siehe Vakil 18.5.6.) Könnte etwas mit der Smithschen Normalform zu tun
  haben.

* Endlich relatives Spektrum als internes Spektrum verstehen.
  Spec(O_X) ist vielleicht nicht unbedingt der Punkt (sollte er aber sein!),
  aber zumindest ein lokaler Raum.

* Sei E --> X ein topologisches Vektorbündel.
  Dann kann man seine Projektivierung konstruieren: P(E) --> X.
  Kann man das intern verstehen?

* Welche Körperbedingung erfüllt K_X? Damit es zumindest ein lokaler Ring wird,
  sollte die Menge der regulären Elemente von O_X einen Filter bilden (siehe
  spektrum.txt). Dazu bräuchte

      x + y regulär  ==>  x regulär  oder  y regulär.

* Unter gewissen Umständen gilt bei eigentlichen Abbildungen f, dass
  f_* O_X ~~ O_Y. Siehe
  http://mathoverflow.net/questions/63301/when-will-the-pushforward-of-a-structure-sheaf-still-be-a-structure-sheaf.
  Kann man das verwenden, um intern Eigentlichkeit zu charakterisieren?

* Kripke-Joyal-Semantik auf (E,j) durch Kripke-Joyal-Semantik auf E
  ausdrücken! Siehe auch:
  http://math.stackexchange.com/questions/177484/what-is-a-lawvere-tierney-topology

* Endlich verstehen, direkt anhand der Kripke-Joyal-Semantik:
  Wieso gelten geometrische Formeln genau dann, wenn sie halmweise gelten?


=== math.se-Antwort

http://math.stackexchange.com/questions/394194/what-does-a-proof-in-an-internal-logic-actually-look-like/394981#394981

Here is an arbitrary example from algebraic geometry. We'll prove the following
well-known statement about $\mathcal{O}_X$-modules on reduced schemes $X$ by
reducing to constructive linear algebra interpreted in the topos
$\mathrm{Sh}(X)$ of sheaves on $X$:

> Let $\mathcal{F}$ be an $\mathcal{O}_X$-module locally of finite type.
> Then $\mathcal{F}$ is locally free iff its rank is constant.

We can translate this statement into the internal language of $\mathrm{Sh}(X)$
by the following dictionary:

 - In the internal language, the sheaf of rings $\mathcal{O}_X$ looks like an ordinary ring.
 - Accordingly, $\mathcal{F}$ looks like an ordinary module on that ring.
 - $\mathcal{F}$ is locally of finite type iff it is finitely generated from
   the internal point of view.
 - $\mathcal{F}$ is locally free iff it is a free module from the internal
   point of view.
 - Internally, we can define the rank of $\mathcal{F}$ as the minimal number
   of elements needed to generate $\mathcal{F}$. But constructively,
   the natural numbers may fail to have minima of arbitrary inhabited sets (see
   [this enlightening blog post by Andrej Bauer][1]), so this minimal number
   might not actually be an (internal) natural number, but be an element of a
   suitable completion. Externally, the rank defined this way induces a upper
   semicontinuous function on $X$ (see [nLab and the Mulvey reference therein][2]); it is constant iff internally, the minimal number of
   generators is an actual natural number.
 - Finally, the scheme $X$ is reduced iff $\mathcal{O}_X$ looks like an
   ordinary reduced ring from the internal perspective. This in turn is
   equivalent to $\mathcal{O}_X$ being a so-called residue field from the
   internal point of view (i.e. a non-trivial ring with every non-unit being
   zero).

So the statement follows if we can give a constructive proof of the following
linear algebra fact:

> Let $A$ be a residue field and let $M$ be a finitely generated $A$-module.
> Then $A$ is free iff the minimal number of elements needed to generate $M$
> as an $A$-module is an actual natural number.

The direction "$\Rightarrow$" is clear. For the direction "$\Leftarrow$",
consider a minimal generating family $x_1,\ldots,x_n$ of $M$ (which exists by
assumption). This family is linearly independent (and therefore a basis): Let $\sum_i \lambda_i x_i =
0$. If any $\lambda_i$ were invertible, the family
$x_1,\ldots,x_{i-1},x_{i+1},\ldots,x_n$ would too generate $M$, contradicting
the minimality. So each $\lambda_i$ is not invertible and thus zero (by assumption on $A$).

  [1]: http://math.andrej.com/2009/09/08/constructive-stone-minima-of-sets-of-natural-numbers/
  [2]: http://ncatlab.org/nlab/show/one-sided+real+number


=== Zweite math.se-Antwort

A topological space (or locale) $X$ is *local* (i.e. in any covering of $X$ by
open subsets at least one such subset is already equal to $X$) iff the internal
language of $\mathrm{Sh}(X)$ fulfils the following disjunction property: If
$(\phi_i)_{i \in I}$ is an arbitrary family of formulas and $\mathrm{Sh}(X)
\models \bigvee_{i \in I} \phi_i$, then there exists an index $i \in I$ such
that $\mathrm{Sh}(X) \models \phi_i$.

Also, if $X$ is local, the internal language fulfils the following existence
property: If $\mathrm{Sh}(X) \models \exists x : \mathcal{F}. \phi(x)$, then
there actually exists a global section $x \in \Gamma(X,\mathcal{F})$ such that
$\mathrm{Sh}(X) \models \phi(x)$.

A topological space $X$ is *compact* iff the internal language of
$\mathrm{Sh}(X)$ fulfils the following property: If $I$ is a directed set,
$(\phi_i)_{i \in I}$ is a monotone family of formulas (meaning $\mathrm{Sh}(X)
\models (\phi_i \Rightarrow \phi_j)$ for $i \preceq j$) and $\mathrm{Sh}(X)
\models \bigvee_{i \in I} \phi_i$, then there exists an index $i \in I$ such
that $\mathrm{Sh}(X) \models \phi_i$. This follows directly from the
order-theoretic characterization of compactness (a space $X$ being compact iff
for any monotone family $(U_i)_{i \in I}$ of open sets with $X = \bigcup_i
U_i$, there exists $i \in I$ such that $X = U_i$).

As an example, you can use the latter characterization to give an internal
proof of [lemma 01BB in the Stacks Project][1] (saying that if a filtered
colimit $\mathcal{F} = \mathrm{colim}_i \mathcal{F}_i$ of
$\mathcal{O}_X$-modules is of finite type on a quasi-compact scheme $X$, then
one of the maps $\mathcal{F}_i \to \mathcal{F}$ is an epimorphism) by reducing
to the following familiar fact of constructive linear algebra: If a filtered
colimit $A = \mathrm{colim}_i A_i$ is finitely generated, one of the maps $A_i
\to A$ is surjective.

Unfortunately, the logical principles above are *meta* properties of the
internal language, so I'm not sure this answers your question.

**Addendum:** An intrinsic characterization of compactness is not possible,
i.e. there cannot exist a formula $\phi$ such that the internal language of the
sheaf topos of a topological space satisfies $\phi$ iff the space is compact:
If a topological space $X$ can be covered by compact subspaces $U_i$, the
formula $\phi$ would be satisfied on each $U_i$ and hence, by the local
character of the internal language, on $X$ as well. If $X$ itself is not
compact, this is a contradiction.

  [1]: http://stacks.math.columbia.edu/tag/01BB


=== Graphen

Siehe Andrej Bauers MO-Post und Sebastiano Vigna, A guided tour in the topos
of graphs.


=== Lefschetz-Prinzip

Siehe Lefschetz's principle, J Barwise, P Eklof.
http://www.sciencedirect.com/science/article/pii/0021869369901173

Lefschetz's principle and local functors.
http://www.ams.org/journals/proc/1973-037-02/S0002-9939-1973-0325389-7/S0002-9939-1973-0325389-7.pdf
